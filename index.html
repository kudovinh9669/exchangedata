<!DOCTYPE html>
<html lang="vi">
<head>
<link rel="icon" type="image/png" href="icon.png" sizes="48x48">
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>C√¥ng c·ª• chuy·ªÉn ƒë·ªïi ƒëa nƒÉng v2</title>
<style>
  :root{
    --bg:#0b1220; --panel:#101a2b; --text:#e7edf7; --muted:#97a4be;
    --acc:#14b8a6; --acc-2:#60a5fa; --border:#20304b;
    --btn:#1f2a44; --btn-h:#273352;
  }
  .light{
    --bg:#f6f8fc; --panel:#ffffff; --text:#0b1220; --muted:#44506a;
    --acc:#0ea5e9; --acc-2:#16a34a; --border:#e5e9f2;
    --btn:#eef2f9; --btn-h:#e4e9f5;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{margin:0;font:16px/1.5 system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;background:var(--bg);color:var(--text)}
  .wrap{max-width:1080px;margin:40px auto;padding:0 16px}
  .frame{background:var(--panel);border:1px solid var(--border);border-radius:14px;overflow:visible;box-shadow:0 10px 30px rgba(0,0,0,.25)}
  .frame-head{display:flex;align-items:center;justify-content:space-between;padding:12px 14px;border-bottom:1px solid var(--border);background:linear-gradient(180deg,rgba(255,255,255,.02),transparent)}
  .brand{display:flex;align-items:center;gap:10px}
  .brand h1{font-size:18px;letter-spacing:.2px;margin:0}
  .muted{color:var(--muted)}
  .theme-btn{appearance:none;border:1px solid var(--border);background:var(--btn);color:var(--text);padding:8px 12px;border-radius:999px;cursor:pointer;font-weight:600;display:flex;align-items:center;gap:8px}
  .theme-btn:hover{background:var(--btn-h)}
  .theme-ico{width:18px;height:18px;display:inline-grid;place-items:center}
  .tabs{display:flex;gap:8px;padding:8px;border-bottom:1px solid var(--border);overflow-x:auto}
  .tab-btn{background:transparent;border:1px solid transparent;color:var(--muted);padding:8px 12px;border-radius:9px;cursor:pointer;white-space:nowrap}
  .tab-btn:hover{color:var(--text)}
  .tab-btn.active{color:var(--text);border-color:var(--border);background:rgba(96,165,250,.08)}
  .panel{padding:18px}
  .grid{display:grid;gap:16px}
  @media(min-width:900px){.grid{grid-template-columns:1fr 1fr}}
  .card{border:1px solid var(--border);border-radius:12px;padding:16px;overflow:visible}
  .title{display:flex;align-items:center;gap:10px;margin:6px 0 12px}
  .dot{width:10px;height:10px;border-radius:50%;background:var(--acc)}
  .row{display:flex;flex-wrap:wrap;gap:12px;align-items:end}
  label{display:block;font-size:13px;color:var(--muted);margin-bottom:6px}
  input[type="number"],select,input[type="date"]{
    width:100%;min-width:140px;max-width:230px;padding:10px 12px;border-radius:10px;border:1px solid var(--border);
    background:transparent;color:var(--text);outline:none
  }
  select,option{background-color:var(--panel);color:var(--text)}
  select:focus,input:focus{outline:2px solid var(--acc-2);outline-offset:1px}
  input[type="checkbox"]{width:18px;height:18px}
  .btn{background:var(--acc);color:#fff;border:0;padding:10px 14px;border-radius:10px;cursor:pointer;font-weight:600}
  .btn:hover{filter:brightness(1.05)}
  .icon-btn{width:40px;height:40px;border-radius:10px;display:grid;place-items:center;border:1px solid var(--border);background:transparent;cursor:pointer}
  .icon-btn:hover{background:var(--btn-h)}
  .result{margin-top:10px;padding:12px;border:1px dashed var(--border);border-radius:10px}
  .foot{padding:14px;border-top:1px dashed var(--border);text-align:center;color:var(--muted);font-size:13px}
  .status{font-size:13px;color:var(--muted)}
  .radio-row{display:flex;gap:14px;align-items:center}
</style>
</head>
<body>
<div class="wrap">
  <div class="frame" id="app-frame">
    <!-- Header -->
    <div class="frame-head">
      <div class="brand">
        <svg class="theme-ico" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/></svg>
        <h1>Toolkit ‚Ä¢ <span class="muted">T·∫•t c·∫£ c√¥ng c·ª•</span></h1>
      </div>
      <button id="themeBtn" class="theme-btn" aria-label="ƒê·ªïi giao di·ªán"><span class="theme-ico" id="themeIcon">üåô</span><span id="themeText">T·ªëi</span></button>
    </div>

    <!-- Tabs -->
    <div class="tabs" id="tabbar">
      <button class="tab-btn active" data-tab="tab-lunisolar">√Çm‚ÄìD∆∞∆°ng L·ªãch</button>
      <button class="tab-btn" data-tab="tab-length">ƒê·ªô d√†i</button>
      <button class="tab-btn" data-tab="tab-mass">Kh·ªëi l∆∞·ª£ng</button>
      <button class="tab-btn" data-tab="tab-volume">Th·ªÉ t√≠ch</button>
      <button class="tab-btn" data-tab="tab-currency">Ti·ªÅn t·ªá (Realtime)</button>
      <button class="tab-btn" data-tab="tab-time">Th·ªùi gian</button>
      <button class="tab-btn" data-tab="tab-date">Ng√†y</button>
      <button class="tab-btn" data-tab="tab-temp">Nhi·ªát ƒë·ªô</button>
      <button class="tab-btn" data-tab="tab-bmi">BMI</button>
      <button class="tab-btn" data-tab="tab-percent">Ph·∫ßn trƒÉm</button>
      <button class="tab-btn" data-tab="tab-dob">Sinh nh·∫≠t (t·ª≠ vi & ho√†ng ƒë·∫°o)</button>
    </div>

    <div class="panel">
      <!-- ========== √Çm‚ÄìD∆∞∆°ng L·ªãch ========== -->
      <section class="tab-panel" id="tab-lunisolar">
        <div class="row" style="justify-content:space-between;gap:16px;margin-bottom:8px">
          <div class="muted">Tra c·ª©u l·ªãch √Çm ‚áÑ D∆∞∆°ng (1900‚Äì2100)</div>
          <div class="row" style="align-items:center">
            <label class="muted" style="margin:0 6px 0 0">M√∫i gi·ªù</label>
            <select id="tzGlobal">
              <option value="7" selected>GMT+7 (VN)</option><option value="8">GMT+8</option><option value="0">GMT</option>
            </select>
          </div>
        </div>
        <div class="grid">
          <div class="card">
            <div class="title"><span class="dot"></span><h3 style="margin:0">D∆∞∆°ng ‚Üí √Çm</h3></div>
            <div class="row">
              <div><label>Ng√†y</label><input id="sDay" type="number" min="1" max="31" value="1"></div>
              <div><label>Th√°ng</label><input id="sMonth" type="number" min="1" max="12" value="1"></div>
              <div><label>NƒÉm</label><input id="sYear" type="number" min="1900" max="2100" value="2025"></div>
              <div><label>M√∫i gi·ªù</label>
                <select id="tz1"><option value="7" selected>GMT+7</option><option value="8">GMT+8</option><option value="0">GMT</option></select>
              </div>
              <div><button id="btnS2L" class="btn">Chuy·ªÉn ‚Üí</button></div>
            </div>
            <div id="outS2L" class="result"></div>
            <div id="outS2LCC" class="muted" style="margin-top:6px"></div>
          </div>

          <div class="card">
            <div class="title"><span class="dot" style="background:var(--acc-2)"></span><h3 style="margin:0">√Çm ‚Üí D∆∞∆°ng</h3></div>
            <div class="row">
              <div><label>Ng√†y</label><input id="lDay" type="number" min="1" max="30" value="1"></div>
              <div><label>Th√°ng</label><input id="lMonth" type="number" min="1" max="12" value="1"></div>
              <div><label>NƒÉm</label><input id="lYear" type="number" min="1900" max="2100" value="2025"></div>
              <div class="row" style="align-items:center;margin-bottom:8px"><input id="lLeap" type="checkbox" /><label for="lLeap">Th√°ng nhu·∫≠n</label></div>
              <div><label>M√∫i gi·ªù</label>
                <select id="tz2"><option value="7" selected>GMT+7</option><option value="8">GMT+8</option><option value="0">GMT</option></select>
              </div>
              <div><button id="btnL2S" class="btn">‚Üê Chuy·ªÉn</button></div>
            </div>
            <div id="outL2S" class="result"></div>
            <div id="outL2SCC" class="muted" style="margin-top:6px"></div>
          </div>
        </div>
        <div class="foot">V√≠ d·ª• ki·ªÉm ch·ª©ng: √Çm l·ªãch <b>01/01/2026</b> ‚Üí D∆∞∆°ng l·ªãch <b>17/02/2026</b> (GMT+7).</div>
      </section>

      <!-- ========== ƒê·ªô d√†i ========== -->
      <section class="tab-panel" id="tab-length" hidden>
        <div class="card">
          <div class="title"><span class="dot" style="background:var(--acc-2)"></span><h3 style="margin:0">Chuy·ªÉn ƒë·ªïi ƒê·ªô d√†i</h3></div>
          <div class="row">
            <div><label>Gi√° tr·ªã</label><input id="lenAmount" type="number" value="1" step="any"></div>
            <div><label>T·ª´</label><select id="lenFrom"></select></div>
            <div><label class="muted" style="visibility:hidden">ƒê·ªïi</label><button id="lenSwap" class="icon-btn" aria-label="ƒê·ªïi chi·ªÅu"><span style="font-size:18px">‚áÑ</span></button></div>
            <div><label>ƒê·∫øn</label><select id="lenTo"></select></div>
            <div><label class="muted" style="visibility:hidden">_</label><button id="lenConvert" class="btn">Quy ƒë·ªïi</button></div>
          </div>
          <div id="lenResult" class="result"></div>
        </div>
      </section>

      <!-- ========== Kh·ªëi l∆∞·ª£ng ========== -->
      <section class="tab-panel" id="tab-mass" hidden>
        <div class="card">
          <div class="title"><span class="dot" style="background:#f59e0b"></span><h3 style="margin:0">Chuy·ªÉn ƒë·ªïi Kh·ªëi l∆∞·ª£ng</h3></div>
          <div class="row">
            <div><label>Gi√° tr·ªã</label><input id="massAmount" type="number" value="1" step="any"></div>
            <div><label>T·ª´</label><select id="massFrom"></select></div>
            <div><label class="muted" style="visibility:hidden">ƒê·ªïi</label><button id="massSwap" class="icon-btn" aria-label="ƒê·ªïi chi·ªÅu"><span style="font-size:18px">‚áÑ</span></button></div>
            <div><label>ƒê·∫øn</label><select id="massTo"></select></div>
            <div><label class="muted" style="visibility:hidden">_</label><button id="massConvert" class="btn">Quy ƒë·ªïi</button></div>
          </div>
          <div id="massResult" class="result"></div>
          <div class="muted" style="margin-top:6px">ƒê∆°n v·ªã: mg, g, kg, t, oz, lb</div>
        </div>
      </section>

      <!-- ========== Th·ªÉ t√≠ch ========== -->
      <section class="tab-panel" id="tab-volume" hidden>
        <div class="card">
          <div class="title"><span class="dot" style="background:#a78bfa"></span><h3 style="margin:0">Chuy·ªÉn ƒë·ªïi Th·ªÉ t√≠ch</h3></div>
          <div class="row">
            <div><label>Gi√° tr·ªã</label><input id="volAmount" type="number" value="1" step="any"></div>
            <div><label>T·ª´</label><select id="volFrom"></select></div>
            <div><label class="muted" style="visibility:hidden">ƒê·ªïi</label><button id="volSwap" class="icon-btn" aria-label="ƒê·ªïi chi·ªÅu"><span style="font-size:18px">‚áÑ</span></button></div>
            <div><label>ƒê·∫øn</label><select id="volTo"></select></div>
            <div><label class="muted" style="visibility:hidden">_</label><button id="volConvert" class="btn">Quy ƒë·ªïi</button></div>
          </div>
          <div id="volResult" class="result"></div>
          <div class="muted" style="margin-top:6px">ƒê∆°n v·ªã: ml, l, m¬≥, in¬≥, ft¬≥, gal (US), gal (UK)</div>
        </div>
      </section>

      <!-- ========== Ti·ªÅn t·ªá (Realtime) ========== -->
      <section class="tab-panel" id="tab-currency" hidden>
        <div class="card">
          <div class="title"><span class="dot" style="background:#34d399"></span><h3 style="margin:0">Chuy·ªÉn ƒë·ªïi Ti·ªÅn t·ªá (ExchangeRate-API)</h3></div>
          <div class="row">
            <div><label>S·ªë ti·ªÅn</label><input id="fxAmount" type="number" value="100" step="any"></div>
            <div><label>T·ª´</label><select id="fxFrom"></select></div>
            <div><label class="muted" style="visibility:hidden">ƒê·ªïi</label><button id="fxSwap" class="icon-btn" aria-label="ƒê·ªïi chi·ªÅu"><span style="font-size:18px">‚áÑ</span></button></div>
            <div><label>ƒê·∫øn</label><select id="fxTo"></select></div>
            <div><label class="muted" style="visibility:hidden">_</label><button id="fxConvert" class="btn">Quy ƒë·ªïi</button></div>
          </div>
          <div id="fxResult" class="result"></div>
          <div class="status" id="fxStatus">ƒêang t·∫£i danh s√°ch m√£ ti·ªÅn t·ªá‚Ä¶</div>
        </div>
      </section>

      <!-- ========== Th·ªùi gian ========== -->
      <section class="tab-panel" id="tab-time" hidden>
        <div class="card">
          <div class="title"><span class="dot" style="background:#22c55e"></span><h3 style="margin:0">Chuy·ªÉn ƒë·ªïi Th·ªùi gian</h3></div>
          <div class="row">
            <div><label>Gi√° tr·ªã</label><input id="tVal" type="number" value="60" step="any"></div>
            <div><label>T·ª´</label>
              <select id="tFrom">
                <option value="y">NƒÉm</option>
                <option value="mo">Th√°ng</option>
                <option value="d">Ng√†y</option>
                <option value="h">Gi·ªù</option>
                <option value="m" selected>Ph√∫t</option>
                <option value="s">Gi√¢y</option>
              </select>
            </div>
            <div><label class="muted" style="visibility:hidden">ƒê·ªïi</label><button id="tSwap" class="icon-btn" aria-label="ƒê·ªïi chi·ªÅu"><span style="font-size:18px">‚áÑ</span></button></div>
            <div><label>ƒê·∫øn</label>
              <select id="tTo">
                <option value="y">NƒÉm</option>
                <option value="mo">Th√°ng</option>
                <option value="d">Ng√†y</option>
                <option value="h">Gi·ªù</option>
                <option value="m">Ph√∫t</option>
                <option value="s" selected>Gi√¢y</option>
              </select>
            </div>
            <div>
              <label>K·∫øt qu·∫£</label>
              <div class="radio-row">
                <label><input type="radio" name="tMode" value="dec" checked> Th·∫≠p ph√¢n</label>
                <label><input type="radio" name="tMode" value="split"> Ph√¢n t√°ch (vd: 1 ph√∫t 18 gi√¢y)</label>
              </div>
            </div>
            <div><label class="muted" style="visibility:hidden">_</label><button id="tConvert" class="btn">Quy ƒë·ªïi</button></div>
          </div>
          <div id="tOut" class="result"></div>
          <div class="muted" style="margin-top:6px">Quy ∆∞·ªõc: <b>1 nƒÉm = 365 ng√†y</b>, <b>1 th√°ng = 30 ng√†y</b>.</div>
        </div>
      </section>

      <!-- ========== Ng√†y ========== -->
      <section class="tab-panel" id="tab-date" hidden>
        <div class="card">
          <div class="title"><span class="dot" style="background:#f97316"></span><h3 style="margin:0">T√≠nh kho·∫£ng c√°ch gi·ªØa 2 ng√†y</h3></div>
          <div class="row">
            <div><label>Ng√†y b·∫Øt ƒë·∫ßu</label><input id="dFrom" type="date"></div>
            <div><label>Ng√†y k·∫øt th√∫c</label><input id="dTo" type="date"></div>
            <div><label class="muted" style="visibility:hidden">_</label><button id="dCalc" class="btn">T√≠nh</button></div>
          </div>
          <div id="dOut" class="result"></div>
          <div class="muted" style="margin-top:6px">C√°ch t√≠nh: <b>lo·∫°i tr·ª´</b> (s·ªë ng√†y = ng√†y_k·∫øt_th√∫c ‚àí ng√†y_b·∫Øt_ƒë·∫ßu). V√≠ d·ª•: 29/10 ‚Üí 08/11 = 10 ng√†y.</div>
        </div>
      </section>

      <!-- ========== Nhi·ªát ƒë·ªô ========== -->
      <section class="tab-panel" id="tab-temp" hidden>
        <div class="card">
          <div class="title"><span class="dot" style="background:#ef4444"></span><h3 style="margin:0">Chuy·ªÉn ƒë·ªïi Nhi·ªát ƒë·ªô</h3></div>
          <div class="row">
            <div><label>Gi√° tr·ªã</label><input id="tmpVal" type="number" value="100" step="any"></div>
            <div><label>T·ª´</label>
              <select id="tmpFrom">
                <option value="C" selected>¬∞C</option>
                <option value="F">¬∞F</option>
                <option value="K">K</option>
              </select>
            </div>
            <div><label class="muted" style="visibility:hidden">swap</label><button id="tmpSwap" class="icon-btn" aria-label="ƒê·ªïi chi·ªÅu"><span style="font-size:18px">‚áÑ</span></button></div>
            <div><label>ƒê·∫øn</label>
              <select id="tmpTo">
                <option value="C">¬∞C</option>
                <option value="F" selected>¬∞F</option>
                <option value="K">K</option>
              </select>
            </div>
            <div><label class="muted" style="visibility:hidden">_</label><button id="tmpConvert" class="btn">Quy ƒë·ªïi</button></div>
          </div>
          <div id="tmpOut" class="result"></div>
        </div>
      </section>

      <!-- ========== BMI ========== -->
      <section class="tab-panel" id="tab-bmi" hidden>
        <div class="card">
          <div class="title"><span class="dot" style="background:#10b981"></span><h3 style="margin:0">T√≠nh ch·ªâ s·ªë BMI</h3></div>
          <div class="row">
            <div><label>Chi·ªÅu cao (cm)</label><input id="bmiH" type="number" value="170" step="any"></div>
            <div><label>C√¢n n·∫∑ng (kg)</label><input id="bmiW" type="number" value="65" step="any"></div>
            <div><label class="muted" style="visibility:hidden">_</label><button id="bmiCalc" class="btn">T√≠nh BMI</button></div>
          </div>
          <div id="bmiOut" class="result"></div>
          <div class="muted" style="margin-top:6px">Ph√¢n lo·∫°i (WHO): &lt;18.5 G·∫ßy ‚Ä¢ 18.5‚Äì24.9 B√¨nh th∆∞·ªùng ‚Ä¢ 25‚Äì29.9 Th·ª´a c√¢n ‚Ä¢ 30‚Äì34.9 B√©o ph√¨ I ‚Ä¢ 35‚Äì39.9 B√©o ph√¨ II ‚Ä¢ ‚â•40 B√©o ph√¨ III.</div>
        </div>
      </section>

      <!-- ========== Ph·∫ßn trƒÉm ========== -->
      <section class="tab-panel" id="tab-percent" hidden>
        <div class="card">
          <div class="title"><span class="dot" style="background:#06b6d4"></span><h3 style="margin:0">T√≠nh Ph·∫ßn trƒÉm</h3></div>

          <div class="row">
            <div><label>X% c·ªßa N</label>
              <input id="pctX" type="number" value="10" step="any" placeholder="X (%)">
            </div>
            <div><label>N</label>
              <input id="pctN" type="number" value="200" step="any" placeholder="N">
            </div>
            <div><label class="muted" style="visibility:hidden">_</label><button id="pctCalc1" class="btn">T√≠nh</button></div>
          </div>
          <div id="pctOut1" class="result"></div>

          <div class="row" style="margin-top:10px">
            <div><label>TƒÉng/Gi·∫£m N theo X%</label>
              <select id="pctMode"><option value="inc" selected>TƒÉng</option><option value="dec">Gi·∫£m</option></select>
            </div>
            <div><label>N</label><input id="pctBase" type="number" value="200" step="any"></div>
            <div><label>X (%)</label><input id="pctRate" type="number" value="10" step="any"></div>
            <div><label class="muted" style="visibility:hidden">_</label><button id="pctCalc2" class="btn">T√≠nh</button></div>
          </div>
          <div id="pctOut2" class="result"></div>

          <div class="row" style="margin-top:10px">
            <div><label>A l√† bao nhi√™u % c·ªßa B?</label><input id="pctA" type="number" value="20" step="any" placeholder="A"></div>
            <div><label>B</label><input id="pctB" type="number" value="200" step="any" placeholder="B"></div>
            <div><label class="muted" style="visibility:hidden">_</label><button id="pctCalc3" class="btn">T√≠nh</button></div>
          </div>
          <div id="pctOut3" class="result"></div>
        </div>
      </section>

      <!-- ========== Sinh nh·∫≠t (t·ª≠ vi & ho√†ng ƒë·∫°o) ========== -->
      <section class="tab-panel" id="tab-dob" hidden>
        <div class="card">
          <div class="title"><span class="dot" style="background:#eab308"></span><h3 style="margin:0">Th√¥ng tin t·ª´ Ng√†y sinh</h3></div>
          <div class="row">
            <div><label>Ng√†y sinh (D∆∞∆°ng l·ªãch)</label><input id="dobDate" type="date"></div>
            <div><label>M√∫i gi·ªù (cho √¢m l·ªãch)</label>
              <select id="dobTz">
                <option value="7" selected>GMT+7 (VN)</option><option value="8">GMT+8</option><option value="0">GMT</option>
              </select>
            </div>
            <div><label class="muted" style="visibility:hidden">_</label><button id="dobCalc" class="btn">Xem th√¥ng tin</button></div>
          </div>
          <div id="dobOut" class="result"></div>
          <div class="muted" style="margin-top:6px">Bao g·ªìm: <b>√Çm l·ªãch</b> (ng√†y/th√°ng/nƒÉm & Can‚ÄìChi), <b>cung Ho√†ng ƒë·∫°o (T√¢y)</b>, <b>con gi√°p</b> theo nƒÉm √¢m.</div>
        </div>
      </section>
    </div>
  </div>
</div>

<script>
/* ===== Theme ===== */
(function(){const b=document.getElementById('themeBtn'),i=document.getElementById('themeIcon'),t=document.getElementById('themeText');const saved=localStorage.getItem('theme')||'dark';if(saved==='light')document.documentElement.classList.add('light');function u(){const L=document.documentElement.classList.contains('light');i.textContent=L?'‚òÄÔ∏è':'üåô';t.textContent=L?'S√°ng':'T·ªëi'}u();b.addEventListener('click',()=>{const L=!document.documentElement.classList.contains('light');document.documentElement.classList.toggle('light',L);localStorage.setItem('theme',L?'light':'dark');u();});})();

/* ===== Tabs ===== */
(function(){const btns=[...document.querySelectorAll('.tab-btn')],panels=[...document.querySelectorAll('.tab-panel')];function act(id){btns.forEach(b=>b.classList.toggle('active',b.dataset.tab===id));panels.forEach(p=>p.hidden=(p.id!==id));}btns.forEach(b=>b.addEventListener('click',()=>act(b.dataset.tab)));act('tab-dob');})(); // m·ªü tab Sinh nh·∫≠t ƒë·ªÉ b·∫°n test ngay

/* ===== Helpers ===== */
const $=id=>document.getElementById(id);
const setResult=(el,html,ok=true)=>el.innerHTML=`<div style="color:${ok?'var(--acc-2)':'#f43f5e'}">${html}</div>`;
const VN_DOW=["Ch·ªß Nh·∫≠t","Th·ª© Hai","Th·ª© Ba","Th·ª© T∆∞","Th·ª© NƒÉm","Th·ª© S√°u","Th·ª© B·∫£y"];

/* ===== L·ªãch √Çm‚ÄìD∆∞∆°ng ===== */
const CAN=["Gi√°p","·∫§t","B√≠nh","ƒêinh","M·∫≠u","K·ª∑","Canh","T√¢n","Nh√¢m","Qu√Ω"];
const CHI=["T√Ω","S·ª≠u","D·∫ßn","M√£o","Th√¨n","T·ªµ","Ng·ªç","M√πi","Th√¢n","D·∫≠u","Tu·∫•t","H·ª£i"];
function jdFromDate(d,m,y){const a=Math.floor((14-m)/12);const y2=y+4800-a;const m2=m+12*a-3;return d+Math.floor((153*m2+2)/5)+365*y2+Math.floor(y2/4)-Math.floor(y2/100)+Math.floor(y2/400)-32045;}
function ccDay(d,m,y){const jd=jdFromDate(d,m,y);return CAN[(jd+9)%10]+" "+CHI[(jd+1)%12];}
function ccYear(y){return CAN[(y+6)%10]+" "+CHI[(y+8)%12];}
function ccMonth(lm,ly){const yi=(ly+6)%10;const fs=(yi*2+2)%10;return CAN[(fs+(lm-1))%10]+" "+CHI[(lm+1)%12];}
const lunarInfo=[0x04bd8,0x04ae0,0x0a570,0x054d5,0x0d260,0x0d950,0x16554,0x056a0,0x09ad0,0x055d2,0x04ae0,0x0a5b6,0x0a4d0,0x0d250,0x1d255,0x0b540,0x0d6a0,0x0ada2,0x095b0,0x14977,0x04970,0x0a4b0,0x0b4b5,0x06a50,0x06d40,0x1ab54,0x02b60,0x09570,0x052f2,0x04970,0x06566,0x0d4a0,0x0ea50,0x06e95,0x05ad0,0x02b60,0x186e3,0x092e0,0x1c8d7,0x0c950,0x0d4a0,0x1d8a6,0x0b550,0x056a0,0x1a5b4,0x025d0,0x092d0,0x0d2b2,0x0a950,0x0b557,0x06ca0,0x0b550,0x15355,0x04da0,0x0a5d0,0x14573,0x052d0,0x0a9a8,0x0e950,0x06aa0,0x0aea6,0x0ab50,0x04b60,0x0aae4,0x0a570,0x05260,0x0f263,0x0d950,0x05b57,0x056a0,0x096d0,0x04dd5,0x04ad0,0x0a4d0,0x0d4d4,0x0d250,0x0d558,0x0b540,0x0b5a0,0x195a6,0x095b0,0x049b0,0x0a974,0x0a4b0,0x0b27a,0x06a50,0x06d40,0x0af46,0x0ab60,0x09570,0x04af5,0x04970,0x064b0,0x074a3,0x0ea50,0x06b58,0x05ac0,0x0ab60,0x096d5,0x092e0,0x0c960,0x0d954,0x0d4a0,0x0da50,0x07552,0x056a0,0x0abb7,0x025d0,0x092d0,0x0cab5,0x0a950,0x0b4a0,0x0baa4,0x0ad50,0x055d9,0x04ba0,0x0a5b0,0x15176,0x052b0,0x0a930,0x07954,0x06aa0,0x0ad50,0x05b52,0x04b60,0x0a6e6,0x0a4e0,0x0d260,0x0ea65,0x0d530,0x05aa0,0x076a3,0x096d0,0x04afb,0x04ad0,0x0a4d0,0x1d0b6,0x0d250,0x0d520,0x0dd45,0x0b5a0,0x056d0,0x055b2,0x049b0,0x0a577,0x0a4b0,0x0aa50,0x1b255,0x06d20,0x0ada0];
const baseDate=new Date(Date.UTC(1900,0,31));
function lYearDays(y){let s=348,info=lunarInfo[y-1900];for(let i=0x8000;i>0x8;i>>=1){if(info&i)s++;}return s+leapDays(y);}
function leapMonth(y){return lunarInfo[y-1900]&0xf;}
function leapDays(y){if(leapMonth(y))return(lunarInfo[y-1900]&0x10000)?30:29;return 0;}
function monthDays(y,m){return(lunarInfo[y-1900]&(0x10000>>m))?30:29;}
function solarToLunar(dd,mm,yy,tz=7){const dateUTC=Date.UTC(yy,mm-1,dd)+tz*3600*1000;let offset=Math.floor((dateUTC-baseDate.getTime())/86400000);if(offset<0)throw new Error("Ngo√†i ph·∫°m vi (tr∆∞·ªõc 1900-01-31)");let year,month,day;let leap=false;for(year=1900;year<2101&&offset>=0;year++){const days=lYearDays(year);if(offset<days)break;offset-=days;}if(year==2101)throw new Error("Ngo√†i ph·∫°m vi (sau 2100)");const leapM=leapMonth(year);for(month=1;month<=12;month++){let days=monthDays(year,month);if(leapM&&month===leapM+1&&!leap){month--;leap=true;days=leapDays(year);}else{leap=false;}if(offset<days)break;offset-=days;}day=offset+1;return{day,month,year,leap};}
function lunarToSolar(ld,lm,ly,isLeap=false,tz=7){if(ly<1900||ly>2100)throw new Error("NƒÉm ngo√†i ph·∫°m vi");const leapM=leapMonth(ly);if(isLeap&&(leapM===0||lm!==leapM))throw new Error("NƒÉm n√†y kh√¥ng c√≥ th√°ng nhu·∫≠n "+lm);if(ld<1||ld>30)throw new Error("Ng√†y √¢m kh√¥ng h·ª£p l·ªá");let offset=0;for(let i=1;i<lm;i++){offset+=monthDays(ly,i);if(leapM&&i===leapM)offset+=leapDays(ly);}if(isLeap)offset+=monthDays(ly,lm);offset+=(ld-1);let d=new Date(baseDate.getTime());for(let y=1900;y<ly;y++)d.setUTCDate(d.getUTCDate()+lYearDays(y));d.setUTCDate(d.getUTCDate()+offset);const res=new Date(d.getTime()+tz*3600*1000);return{day:res.getUTCDate(),month:res.getUTCMonth()+1,year:res.getUTCFullYear()};}
$('tzGlobal').addEventListener('change',()=>{$('tz1').value=$('tzGlobal').value;$('tz2').value=$('tzGlobal').value;});
$('btnS2L').addEventListener('click',()=>{const d=+$('sDay').value,m=+$('sMonth').value,y=+$('sYear').value,tz=+$('tz1').value;try{const r=solarToLunar(d,m,y,tz);setResult($('outS2L'),`√Çm l·ªãch: <b>${String(r.day).padStart(2,'0')}/${String(r.month).padStart(2,'0')}/${r.year}${r.leap?' (nhu·∫≠n)':''}</b>`);$('outS2LCC').innerHTML=`Ng√†y: <b>${ccDay(d,m,y)}</b> ‚Ä¢ Th√°ng: <b>${ccMonth(r.month,r.year)}</b> ‚Ä¢ NƒÉm: <b>${ccYear(r.year)}</b>`;}catch(e){setResult($('outS2L'),e.message,false);$('outS2LCC').textContent='';}});
$('btnL2S').addEventListener('click',()=>{const d=+$('lDay').value,m=+$('lMonth').value,y=+$('lYear').value,isleap=$('lLeap').checked,tz=+$('tz2').value;try{const r=lunarToSolar(d,m,y,isleap,tz);setResult($('outL2S'),`D∆∞∆°ng l·ªãch: <b>${String(r.day).padStart(2,'0')}/${String(r.month).padStart(2,'0')}/${r.year}</b>`);$('outL2SCC').innerHTML=`Ng√†y: <b>${ccDay(r.day,r.month,r.year)}</b> ‚Ä¢ Th√°ng: <b>${ccMonth(m,y)}</b> ‚Ä¢ NƒÉm: <b>${ccYear(y)}</b>`;}catch(e){setResult($('outL2S'),e.message,false);$('outL2SCC').textContent='';}});

/* ===== ƒê·ªô d√†i ===== */
const LEN_UNITS={mm:{name:'Milim√©t',toMeter:0.001},cm:{name:'Centim√©t',toMeter:0.01},m:{name:'M√©t',toMeter:1},km:{name:'Kil√¥m√©t',toMeter:1000},in:{name:'Inch',toMeter:0.0254},ft:{name:'Foot',toMeter:0.3048},yd:{name:'Yard',toMeter:0.9144},mi:{name:'D·∫∑m',toMeter:1609.34}};
(function(){const f=$('lenFrom'),t=$('lenTo');for(const k in LEN_UNITS){const label=`${LEN_UNITS[k].name} (${k})`;f.insertAdjacentHTML('beforeend',`<option value="${k}">${label}</option>`);t.insertAdjacentHTML('beforeend',`<option value="${k}">${label}</option>`);}f.value='m';t.value='cm';function convert(){const amt=parseFloat($('lenAmount').value);if(isNaN(amt))return;const val=(amt*LEN_UNITS[f.value].toMeter)/LEN_UNITS[t.value].toMeter;setResult($('lenResult'),`${amt.toLocaleString('vi-VN')} ${f.value} = <b>${val.toLocaleString('vi-VN',{maximumFractionDigits:6})}</b> ${t.value}`);}$('lenConvert').addEventListener('click',convert);$('lenSwap').addEventListener('click',()=>{[f.value,t.value]=[t.value,f.value];convert();});convert();})();

/* ===== Kh·ªëi l∆∞·ª£ng ===== */
const MASS_UNITS={mg:{name:'Miligram',toKg:0.000001},g:{name:'Gram',toKg:0.001},kg:{name:'Kilogram',toKg:1},t:{name:'T·∫•n (metric)',toKg:1000},oz:{name:'Ounce',toKg:0.028349523125},lb:{name:'Pound',toKg:0.45359237}};
(function(){const f=$('massFrom'),t=$('massTo');for(const k in MASS_UNITS){const label=`${MASS_UNITS[k].name} (${k})`;f.insertAdjacentHTML('beforeend',`<option value="${k}">${label}</option>`);t.insertAdjacentHTML('beforeend',`<option value="${k}">${label}</option>`);}f.value='kg';t.value='lb';function convert(){const amt=parseFloat($('massAmount').value);if(isNaN(amt))return;const val=(amt*MASS_UNITS[f.value].toKg)/MASS_UNITS[t.value].toKg;setResult($('massResult'),`${amt.toLocaleString('vi-VN')} ${f.value} = <b>${val.toLocaleString('vi-VN',{maximumFractionDigits:6})}</b> ${t.value}`);}$('massConvert').addEventListener('click',convert);$('massSwap').addEventListener('click',()=>{[f.value,t.value]=[t.value,f.value];convert();});convert();})();

/* ===== Th·ªÉ t√≠ch ===== */
const VOL_UNITS={ml:{name:'Milil√≠t',toM3:0.000001},l:{name:'L√≠t',toM3:0.001},m3:{name:'M√©t kh·ªëi',toM3:1},in3:{name:'Inch kh·ªëi',toM3:0.000016387064},ft3:{name:'Feet kh·ªëi',toM3:0.028316846592},galUS:{name:'Gallon (US)',toM3:0.003785411784},galUK:{name:'Gallon (UK)',toM3:0.00454609}};
(function(){const f=$('volFrom'),t=$('volTo');for(const k in VOL_UNITS){const label=`${VOL_UNITS[k].name} (${k})`;f.insertAdjacentHTML('beforeend',`<option value="${k}">${label}</option>`);t.insertAdjacentHTML('beforeend',`<option value="${k}">${label}</option>`);}f.value='l';t.value='ml';function convert(){const amt=parseFloat($('volAmount').value);if(isNaN(amt))return;const val=(amt*VOL_UNITS[f.value].toM3)/VOL_UNITS[t.value].toM3;setResult($('volResult'),`${amt.toLocaleString('vi-VN')} ${f.value} = <b>${val.toLocaleString('vi-VN',{maximumFractionDigits:6})}</b> ${t.value}`);}$('volConvert').addEventListener('click',convert);$('volSwap').addEventListener('click',()=>{[f.value,t.value]=[t.value,f.value];convert();});convert();})();

/* ===== Ti·ªÅn t·ªá (Realtime ExchangeRate-API) ===== */
const FX_API_KEY="87372f0f0f69d53b5958b6c2";
const FX_CACHE_KEY="fx_rates_latest_USD";
const FX_CACHE_TTL_MS=12*60*60*1000; // 12h
async function getRates(){
  const cached=localStorage.getItem(FX_CACHE_KEY);
  if(cached){try{const data=JSON.parse(cached);if(Date.now()-data.cachedAt<FX_CACHE_TTL_MS)return data;}catch{}}
  const url=`https://v6.exchangerate-api.com/v6/${FX_API_KEY}/latest/USD`;
  const res=await fetch(url);
  if(!res.ok) throw new Error("HTTP "+res.status);
  const json=await res.json();
  if(json.result!=="success") throw new Error("API error");
  const payload={base:json.base_code,rates:json.conversion_rates,time:json.time_last_update_utc,cachedAt:Date.now()};
  localStorage.setItem(FX_CACHE_KEY,JSON.stringify(payload));
  return payload;
}
(async function initFX(){
  const fromSel=$('fxFrom'),toSel=$('fxTo'),status=$('fxStatus');
  try{
    const data=await getRates();
    const codes=Object.keys(data.rates).sort();
    const opts=codes.map(c=>`<option value="${c}">${c}</option>`).join('');
    fromSel.innerHTML=opts; toSel.innerHTML=opts;
    fromSel.value='USD'; toSel.value='VND';
    status.textContent=`T·ª∑ gi√° n·ªÅn: ${data.base}. C·∫≠p nh·∫≠t: ${data.time}`;
    function convert(){
      const amt=parseFloat($('fxAmount').value); if(isNaN(amt)) return;
      const f=fromSel.value, t=toSel.value;
      const rateF=data.rates[f], rateT=data.rates[t];
      if(rateF==null||rateT==null){ setResult($('fxResult'),'M√£ ti·ªÅn t·ªá kh√¥ng h·ª£p l·ªá.',false); return; }
      const out=amt*(rateT/rateF);
      setResult($('fxResult'), `${amt.toLocaleString('vi-VN')} ${f} = <b>${out.toLocaleString('vi-VN',{maximumFractionDigits:6})}</b> ${t}`);
    }
    $('fxConvert').addEventListener('click',convert);
    $('fxSwap').addEventListener('click',()=>{[fromSel.value,toSel.value]=[toSel.value,fromSel.value];});
  }catch(e){ status.textContent='L·ªói t·∫£i t·ª∑ gi√°: '+e.message; }
})();

/* ===== Th·ªùi gian ===== */
const T_SECONDS={y:365*24*3600, mo:30*24*3600, d:24*3600, h:3600, m:60, s:1};
const T_LABEL={y:"nƒÉm",mo:"th√°ng",d:"ng√†y",h:"gi·ªù",m:"ph√∫t",s:"gi√¢y"};
const ORDER=["y","mo","d","h","m","s"];
$('tSwap').addEventListener('click',()=>{const f=$('tFrom'),t=$('tTo');[f.value,t.value]=[t.value,f.value];});
$('tConvert').addEventListener('click',()=>{
  const val=parseFloat($('tVal').value); if(isNaN(val)) return;
  const from=$('tFrom').value, to=$('tTo').value;
  const mode=[...document.querySelectorAll('input[name="tMode"]')].find(r=>r.checked).value;
  const totalSec=val*T_SECONDS[from], toSec=T_SECONDS[to];
  if(mode==="dec"){
    const out=totalSec/toSec;
    setResult($('tOut'), `${val.toLocaleString('vi-VN')} ${T_LABEL[from]} = <b>${out.toLocaleString('vi-VN',{maximumFractionDigits:6})} ${T_LABEL[to]}</b>`);
  }else{
    const q=Math.floor(totalSec/toSec); const remSec=totalSec-q*toSec;
    const idx=ORDER.indexOf(to); const small=(idx>=0&&idx<ORDER.length-1)?ORDER[idx+1]:null;
    if(!small||remSec===0){ setResult($('tOut'), `${val} ${T_LABEL[from]} = <b>${q} ${T_LABEL[to]}</b>`); }
    else{
      const smallVal=Math.floor(remSec/T_SECONDS[small]);
      setResult($('tOut'), `${val} ${T_LABEL[from]} = <b>${q} ${T_LABEL[to]}</b> <b>${smallVal} ${T_LABEL[small]}</b>`);
    }
  }
});

/* ===== Ng√†y ===== */
function toDateLocal(s){if(!s)return null;const [Y,M,D]=s.split('-').map(Number);return new Date(Y,M-1,D);}
function fmtVN(d){const dd=String(d.getDate()).padStart(2,'0');const mm=String(d.getMonth()+1).padStart(2,'0');const yy=d.getFullYear();return `${dd}/${mm}/${yy}`;}
$('dCalc').addEventListener('click',()=>{
  const s=toDateLocal($('dFrom').value), e=toDateLocal($('dTo').value);
  if(!s||!e){ setResult($('dOut'),'Vui l√≤ng ch·ªçn ƒë·ªß 2 ng√†y.',false); return; }
  const ONE=24*3600*1000; const diff=Math.round((e-s)/ONE);
  setResult($('dOut'), `
    Kho·∫£ng th·ªùi gian t·ª´ <b>${fmtVN(s)}</b> ƒë·∫øn <b>${fmtVN(e)}</b> l√†: <b>${diff}</b> ng√†y<br>
    Ng√†y b·∫Øt ƒë·∫ßu (${fmtVN(s)}): <b>${VN_DOW[s.getDay()]}</b><br>
    Ng√†y k·∫øt th√∫c (${fmtVN(e)}): <b>${VN_DOW[e.getDay()]}</b>
  `);
});
(function(){const ds=new Date(2025,9,29), de=new Date(2025,10,8);
  $('dFrom').value=`${ds.getFullYear()}-${String(ds.getMonth()+1).padStart(2,'0')}-${String(ds.getDate()).padStart(2,'0')}`;
  $('dTo').value  =`${de.getFullYear()}-${String(de.getMonth()+1).padStart(2,'0')}-${String(de.getDate()).padStart(2,'0')}`;
})();

/* ===== Nhi·ªát ƒë·ªô ===== */
function toK(val,unit){
  if(unit==='C') return val+273.15;
  if(unit==='F') return (val-32)*5/9+273.15;
  return val; // K
}
function fromK(k,unit){
  if(unit==='C') return k-273.15;
  if(unit==='F') return (k-273.15)*9/5+32;
  return k;
}
$('tmpSwap').addEventListener('click',()=>{const f=$('tmpFrom'),t=$('tmpTo');[f.value,t.value]=[t.value,f.value];});
$('tmpConvert').addEventListener('click',()=>{
  const v=parseFloat($('tmpVal').value); if(isNaN(v)) return;
  const from=$('tmpFrom').value, to=$('tmpTo').value;
  const out=fromK(toK(v,from),to);
  setResult($('tmpOut'), `${v.toLocaleString('vi-VN')} ¬∞${from} = <b>${out.toLocaleString('vi-VN',{maximumFractionDigits:6})} ¬∞${to}</b>`);
});

/* ===== BMI ===== */
function bmiClass(b){
  if(b<18.5) return {label:"G·∫ßy", color:"#60a5fa", tip:"TƒÉng nƒÉng l∆∞·ª£ng, th√™m ƒë·∫°m & t·∫≠p s·ª©c m·∫°nh."};
  if(b<25)   return {label:"B√¨nh th∆∞·ªùng", color:"#10b981", tip:"Duy tr√¨ ch·∫ø ƒë·ªô ƒÉn c√¢n b·∫±ng & v·∫≠n ƒë·ªông ƒë·ªÅu."};
  if(b<30)   return {label:"Th·ª´a c√¢n", color:"#f59e0b", tip:"TƒÉng v·∫≠n ƒë·ªông, ki·ªÉm so√°t kh·∫©u ph·∫ßn & ƒë∆∞·ªùng."};
  if(b<35)   return {label:"B√©o ph√¨ ƒë·ªô I", color:"#f97316", tip:"T·∫°o th√¢m h·ª•t calo nh·∫π, theo d√µi ti·∫øn ƒë·ªô."};
  if(b<40)   return {label:"B√©o ph√¨ ƒë·ªô II", color:"#ef4444", tip:"Tham kh·∫£o chuy√™n gia dinh d∆∞·ª°ng/b√°c sƒ©."};
  return {label:"B√©o ph√¨ ƒë·ªô III", color:"#dc2626", tip:"C·∫ßn can thi·ªáp y t·∫ø & k·∫ø ho·∫°ch d√†i h·∫°n."};
}
$('bmiCalc').addEventListener('click',()=>{
  const h=parseFloat($('bmiH').value), w=parseFloat($('bmiW').value);
  if(isNaN(h)||isNaN(w)||h<=0||w<=0){ setResult($('bmiOut'),'Vui l√≤ng nh·∫≠p chi·ªÅu cao/c√¢n n·∫∑ng h·ª£p l·ªá.',false); return; }
  const m=h/100; const bmi=w/(m*m);
  const c=bmiClass(bmi);
  setResult($('bmiOut'), `BMI = <b style="color:${c.color}">${bmi.toFixed(1)}</b> ‚Ä¢ Ph√¢n lo·∫°i: <b style="color:${c.color}">${c.label}</b><br><span class="muted">G·ª£i √Ω:</span> ${c.tip}`);
});

/* ===== Ph·∫ßn trƒÉm ===== */
$('pctCalc1').addEventListener('click',()=>{
  const x=parseFloat($('pctX').value), n=parseFloat($('pctN').value);
  if(isNaN(x)||isNaN(n)) return;
  const v=n*x/100;
  setResult($('pctOut1'), `${x}% c·ªßa ${n} = <b>${v.toLocaleString('vi-VN',{maximumFractionDigits:6})}</b>`);
});
$('pctCalc2').addEventListener('click',()=>{
  const mode=$('pctMode').value, n=parseFloat($('pctBase').value), r=parseFloat($('pctRate').value);
  if(isNaN(n)||isNaN(r)) return;
  const v = mode==='inc' ? n*(1+r/100) : n*(1-r/100);
  setResult($('pctOut2'), `${mode==='inc'?'TƒÉng':'Gi·∫£m'} ${n} theo ${r}% = <b>${v.toLocaleString('vi-VN',{maximumFractionDigits:6})}</b>`);
});
$('pctCalc3').addEventListener('click',()=>{
  const a=parseFloat($('pctA').value), b=parseFloat($('pctB').value);
  if(isNaN(a)||isNaN(b)||b===0){ setResult($('pctOut3'),'Vui l√≤ng nh·∫≠p A/B h·ª£p l·ªá (B ‚â† 0).',false); return; }
  const p=a/b*100;
  setResult($('pctOut3'), `${a} l√† <b>${p.toLocaleString('vi-VN',{maximumFractionDigits:6})}%</b> c·ªßa ${b}`);
});

/* ===== Ho√†ng ƒë·∫°o T√¢y (ƒë√£ s·ª≠a chu·∫©n) ===== */
function westernZodiac(month, day){
  // Helper: ki·ªÉm tra ng√†y trong kho·∫£ng, c√≥ x·ª≠ l√Ω kho·∫£ng giao nƒÉm (vd Ma K·∫øt 22/12‚Äì19/1)
  const inRange=(m,d, sM,sD, eM,eD)=>{
    if(sM<eM){ // c√πng nƒÉm
      return (m>sM && m<eM) || (m===sM && d>=sD) || (m===eM && d<=eD);
    }else{ // giao nƒÉm
      return (m> sM || m< eM) || (m===sM && d>=sD) || (m===eM && d<=eD);
    }
  };
  const Z=[
    {name:"Ma K·∫øt", s:[12,22], e:[1,19]},
    {name:"B·∫£o B√¨nh", s:[1,20], e:[2,18]},
    {name:"Song Ng∆∞", s:[2,19], e:[3,20]},
    {name:"B·∫°ch D∆∞∆°ng", s:[3,21], e:[4,19]},
    {name:"Kim Ng∆∞u", s:[4,20], e:[5,20]},
    {name:"Song T·ª≠", s:[5,21], e:[6,20]},
    {name:"C·ª± Gi·∫£i", s:[6,21], e:[7,22]},
    {name:"S∆∞ T·ª≠", s:[7,23], e:[8,22]},
    {name:"X·ª≠ N·ªØ", s:[8,23], e:[9,22]},
    {name:"Thi√™n B√¨nh", s:[9,23], e:[10,22]},
    {name:"B·ªç C·∫°p", s:[10,23], e:[11,21]},
    {name:"Nh√¢n M√£", s:[11,22], e:[12,21]},
  ];
  for(const z of Z){ if(inRange(month,day, z.s[0],z.s[1], z.e[0],z.e[1])) return z.name; }
  // fallback an to√†n
  return "Ma K·∫øt";
}

/* ===== Sinh nh·∫≠t (t·ª≠ vi & ho√†ng ƒë·∫°o) ===== */
function zodiacAnimal(chi){const map={T√Ω:"Chu·ªôt",S·ª≠u:"Tr√¢u",D·∫ßn:"H·ªï",M√£o:"M√®o",Th√¨n:"R·ªìng",T·ªµ:"R·∫Øn",Ng·ªç:"Ng·ª±a",M√πi:"D√™",Th√¢n:"Kh·ªâ",D·∫≠u:"G√†",Tu·∫•t:"Ch√≥",H·ª£i:"L·ª£n"};return map[chi]||chi;}
$('dobCalc').addEventListener('click',()=>{
  const s=$('dobDate').value; const tz=+$('dobTz').value||7;
  const d=toDateLocal(s);
  if(!d){ setResult($('dobOut'),'Vui l√≤ng ch·ªçn ng√†y sinh.',false); return; }
  const dl={dd:d.getDate(), mm:d.getMonth()+1, yy:d.getFullYear()};
  let lunar, err=null;
  try{ lunar=solarToLunar(dl.dd,dl.mm,dl.yy,tz); }catch(e){ err=e.message; }
  const wz = westernZodiac(dl.mm, dl.dd);
  let yearCC='', monthCC='', dayCC='', giap='';
  if(!err && lunar){
    yearCC = ccYear(lunar.year);
    monthCC = ccMonth(lunar.month, lunar.year);
    dayCC   = ccDay(dl.dd, dl.mm, dl.yy);
    giap = zodiacAnimal(yearCC.split(' ').slice(-1)[0]); // l·∫•y Chi c·ªßa nƒÉm √¢m
  }
  const lunarText = err ? `Kh√¥ng ƒë·ªïi ƒë∆∞·ª£c √¢m l·ªãch (${err})` :
    `√Çm l·ªãch: <b>${String(lunar.day).padStart(2,'0')}/${String(lunar.month).padStart(2,'0')}/${lunar.year}${lunar.leap?' (nhu·∫≠n)':''}</b>
     ‚Ä¢ Can‚ÄìChi ng√†y: <b>${dayCC}</b> ‚Ä¢ th√°ng: <b>${monthCC}</b> ‚Ä¢ nƒÉm: <b>${yearCC}</b> (${giap})`;
  const out = `
    Ng√†y sinh (d∆∞∆°ng): <b>${String(dl.dd).padStart(2,'0')}/${String(dl.mm).padStart(2,'0')}/${dl.yy}</b><br>
    Cung Ho√†ng ƒë·∫°o (T√¢y): <b>${wz}</b><br>
    ${lunarText}
  `;
  setResult($('dobOut'), out);
});

// set v√≠ d·ª• m·∫∑c ƒë·ªãnh cho b·∫°n test nhanh (14/09 -> X·ª≠ N·ªØ)
(function(){
  const ex=new Date(1998,8,14); // 14/09/1998
  $('dobDate').value=`${ex.getFullYear()}-${String(ex.getMonth()+1).padStart(2,'0')}-${String(ex.getDate()).padStart(2,'0')}`;
})();
</script>
</body>
</html>
